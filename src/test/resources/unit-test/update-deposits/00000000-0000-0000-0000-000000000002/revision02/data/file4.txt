This is file4 with modifications.