This is file 4 with even more modifications.